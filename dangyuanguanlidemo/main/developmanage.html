<!DOCTYPE html>
<html>
<head>
    <title>使用工具栏</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link href="../assets/css/dpl-min.css" rel="stylesheet" type="text/css"/>
    <link href="../assets/css/bui-min.css" rel="stylesheet" type="text/css"/>
    <link href="../assets/css/page-min.css" rel="stylesheet" type="text/css"/>   <!-- 下面的样式，仅是为了显示代码，而不应该在项目中使用-->
    <link href="../assets/css/prettify.css" rel="stylesheet" type="text/css"/>
</head>

<body>
<div class="demo-content">

    <!-- 简单搜索页 ================================================== -->
    <div class="row" style="margin: 0 auto;">
        <div class="span50 doc-content breadcrumb">
            <form id="J_Form" class=" form-horizontal span50" action="post">
                <div class="row" style="margin-top: 20px;">
                    <div class="control-group span8">
                        <label class="control-label"><s>*</s>机构名称：</label>
                        <div class="controls">
                            <input name="id" type="text" data-rules="{required:true}" class="input-normal control-text">
                        </div>
                    </div>
                    <div class="control-group span8">
                        <label class="control-label"><s>*</s>姓名：</label>
                        <div class="controls">
                            <input name="id" type="text" data-rules="{required:true}" class="input-normal control-text">
                        </div>
                    </div>
                    <div class="control-group span8">
                        <label class="control-label">性别：</label>
                        <div class="controls">
                            <select name="sex">
                                <option value="0">男</option>
                                <option value="1">女</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">

                    <div class="control-group span8 ">
                        <label class="control-label">出生日期：</label>
                        <div class="controls">
                            <input name="birthday" type="text" class="calendar" data-rules="{required:true}">
                        </div>
                    </div>
                    <div class="control-group span8">
                        <label class="control-label"><s>*</s>民族：</label>
                        <div class="controls">
                            <select data-rules="{required:true}" name="type">
                                <option value="">不限</option>
                                <option value="saler">汉族</option>
                                <option value="large">彝族</option>
                                <option value="large">傣族</option>
                                <option value="large">白族</option>
                                <option value="large">彝族</option>
                            </select>
                        </div>
                    </div>
                    <div class="control-group span8">
                        <label class="control-label"><s>*</s>籍贯：</label>
                        <div class="controls">
                            <select data-rules="{required:true}" name="type">
                                <option value="">不限</option>
                                <option value="saler">昆明</option>
                                <option value="large">大理</option>
                                <option value="large">丽江</option>
                                <option value="large">曲靖</option>
                                <option value="large">蒙自</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row" style="margin-bottom: 10px;">
                    <div class="span13 offset8 ">
                        <button type="submit" class="button button-primary">查询>></button>
                    </div>
                </div>
            </form>
            <table cellspacing="0" class="table table-bordered">
                <thead>
                <tr>
                    <th style="text-align: center">序号</th>
                    <th style="text-align: center">机构名称</th>
                    <th style="text-align: center">姓名</th>
                    <th style="text-align: center">性别</th>
                    <th style="text-align: center">籍贯</th>
                    <th style="text-align: center">民族</th>
                    <th style="text-align: center">现状</th>
                    <th style="text-align: center">操作</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td style="text-align: center">1</td>
                    <td style="text-align: center">白龙潭社区</td>
                    <td style="text-align: center">王五</td>
                    <td style="text-align: center">男</td>
                    <td style="text-align: center">昆明</td>
                    <td style="text-align: center">汉族</td>
                    <td style="text-align: center">发展党员</td>
                    <td style="text-align: center">
                        <button id="btnShow" class="button button-primary">详情</button>
                    </td>
                </tr>
                </tbody>
            </table>
            <!--弹出框开始-->
            <!-- 此节点内部的内容会在弹出框内显示,默认隐藏此节点-->
            <div id="content" class="hide" >
                <div id="tableExcel">
                    <div class="span50 doc-content breadcrumb">

                        <table width="750" border="1"  cellpadding="0" cellspacing="1" style="border-color: #dddddd;">
                            <tbody>
                            <tr>
                                <td width="250" v rowspan="6" style="border:1.0000pt solid #dddddd;background:#FFFFFF;">
                                    <p class="MsoNormal"  style="text-align:center;">
                                        <b><span style="font-family:'Arial Unicode MS';font-size:11px;">基本信息</span></b><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>
                                    </p>
                                </td>
                                <td width="221" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;机构名称</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="375" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;白龙潭社区</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="303" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;党员编号</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="207" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;B001</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;姓名</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;赵四</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="203" v rowspan="6" style="border:1.0000pt solid #dddddd;background:#FFFFFF;">
                                    <p class="MsoNormal"  style="text-align:center;">
                                        <img onerror=""
                                             src="../assets/img/mage.png"
                                             width="103" height="120" border="0">
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td width="221" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;性别</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="375" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;男</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="303" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;出生日期</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="207" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;1990/12/3</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;民族</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;汉族</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                            </tr>
                            <tr>
                                <td width="300" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;身份证号码</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="375" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;1452345234542344345</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="303" v style="border:none;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;联系电话</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="207" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;13098765673</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;籍贯</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;昆明</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                            </tr>
                            <tr>
                                <td width="221" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;家庭住址</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="1219" v colspan="5" style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;</span>

                                </td>
                            </tr>
                            <tr>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;入团时间</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;2014/02/09</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;递交入党申请书时间</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;2014/02/09</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;党校结业时间</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;2014/02/09</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                            </tr>
                            <tr>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;入党介绍人</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;李四</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="140" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;现状</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="191" v colspan="3" style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;发展党员</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="span50 doc-content breadcrumb">
                        <table width="750" border="1"  cellpadding="0" cellspacing="1" style="border-color: #dddddd;">
                            <tbody>
                            <tr>
                                <td width="198" v rowspan="3" style="border:1.0000pt solid #dddddd;background:#FFFFFF;">
                                    <p class="MsoNormal"  style="text-align:center;">
                                        <b><span style="font-family:'Arial Unicode MS';font-size:11px;">本人经历</span></b><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>
                                    </p>
                                </td>
                                <td width="150" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;时间<br></span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="336" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;2014/3/2至2015/2/2</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="120" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;单位名称</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="220" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;洛龙街道</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="80" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;内容</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="367" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;党内制度</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                            </tr>
                            <tr>
                                <td width="150" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;证明人</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="336" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;阿木</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                                <td width="120" v style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;">&nbsp;&nbsp;备注</span><span style="font-family:'Arial Unicode MS';color:#39B294;font-size:11px;"></span>

                                </td>
                                <td width="270" v colspan="3" style="border:1.0000pt solid #dddddd;background:#FFFFFF;">

                                    <span style="font-family:'Arial Unicode MS';font-size:11px;">&nbsp;&nbsp;备注信息</span><span style="font-family:'Arial Unicode MS';font-size:11px;"></span>

                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="pull-left" style="position: absolute;top: 95px;left: 328px;"><img src="../assets/img/zhuanzheng.png"
                    width="100" height="100" border="0"></div>
                <button class="button button-danger pull-right" type="button" onclick="method5('tableExcel')"  style="margin-left: 200px;"><i class="icon-white icon-file"></i>导出Excel文件打印</button>
            </div>
            <!--导出Excel文件-->
            <script language="JavaScript" type="text/javascript">
                //方法
                var idTmr;
                function  getExplorer() {
                    var explorer = window.navigator.userAgent ;
                    //ie
                    if (explorer.indexOf("MSIE") >= 0) {
                        return 'ie';
                    }
                    //firefox
                    else if (explorer.indexOf("Firefox") >= 0) {
                        return 'Firefox';
                    }
                    //Chrome
                    else if(explorer.indexOf("Chrome") >= 0){
                        return 'Chrome';
                    }
                    //Opera
                    else if(explorer.indexOf("Opera") >= 0){
                        return 'Opera';
                    }
                    //Safari
                    else if(explorer.indexOf("Safari") >= 0){
                        return 'Safari';
                    }
                }
                function method5(tableid) {
                    if(getExplorer()=='ie')
                    {
                        var curTbl = document.getElementById(tableid);
                        var oXL = new ActiveXObject("Excel.Application");
                        var oWB = oXL.Workbooks.Add();
                        var xlsheet = oWB.Worksheets(1);
                        var sel = document.body.createTextRange();
                        sel.moveToElementText(curTbl);
                        sel.select();
                        sel.execCommand("Copy");
                        xlsheet.Paste();
                        oXL.Visible = true;

                        try {
                            var fname = oXL.Application.GetSaveAsFilename("Excel.xls", "Excel Spreadsheets (*.xls), *.xls");
                        } catch (e) {
                            print("Nested catch caught " + e);
                        } finally {
                            oWB.SaveAs(fname);
                            oWB.Close(savechanges = false);
                            oXL.Quit();
                            oXL = null;
                            idTmr = window.setInterval("Cleanup();", 1);
                        }

                    }
                    else
                    {
                        tableToExcel(tableid)
                    }
                }
                function Cleanup() {
                    window.clearInterval(idTmr);
                    CollectGarbage();
                }
                var tableToExcel = (function() {
                    var uri = 'data:application/vnd.ms-excel;base64,',
                        template = '<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',
                        base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },
                        format = function(s, c) {
                            return s.replace(/{(\w+)}/g,
                                function(m, p) { return c[p]; }) }
                    return function(table, name) {
                        if (!table.nodeType) table = document.getElementById(table)
                        var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
                        window.location.href = uri + base64(format(template, ctx))
                    }
                })()

            </script>
            <!--导出Excel文件-->
            <!-- 使用seajs方式 -->

            <script src="http://g.tbcdn.cn/fi/bui/jquery-1.8.1.min.js"></script>
            <script type="text/javascript" src="../assets/js/seed-min.js"></script>
            <!-- script start -->
            <script type="text/javascript">
                BUI.use('bui/overlay', function (Overlay) {
                    $('#btnShow').on('click', function () {
                        var dialog = new Overlay.Dialog({
                            title: '详情信息',
                            width: 800,
                            height: 345,
                            buttons:[],
                            closeAction: 'destroy', //每次关闭dialog释放
                            //配置详情信息容器的编号
                            contentId: 'content',
                            success: function () {
                                alert('导出Excel打印');
                                this.close();
                            },buttons:[
                                {
                                    text:'关闭',
                                    elCls : 'button button-primary',
                                    handler : function(){
                                        //do some thing
                                        this.close();
                                    },
                                }
                            ],
                        });
                        dialog.show();
                    });
                });
            </script>
            <!-- script end -->
            <!--弹出框结束-->

            <div class="pagination pull-left">
                <ul>
                    <li class="disabled"><a href="#">« 上一页</a></li>
                    <li class="active"><a href="#">1</a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">4</a></li>
                    <li><a href="#">下一页 »</a></li>
                </ul>
            </div>

        </div>
    </div>
    <script type="text/javascript" src="../assets/js/jquery-1.8.1.min.js"></script>
    <script type="text/javascript" src="../assets/js/bui-min.js"></script>
    <script type="text/javascript" src="../assets/js/config-min.js"></script>
    <script type="text/javascript">
        BUI.use(['bui/grid', 'bui/data', 'bui/form'], function (Grid, Data, Form) {
            function delFunction() {
                var selections = grid.getSelection();
                store.remove(selections);
            }

            var form = new Form.HForm({
                srcNode: '#J_Form'
            });
            form.render();

            form.on('beforesubmit', function () {
                if (!editing.isValid()) {
                    return false;
                }
            });


        });
    </script>
</div>
</body>
</html>